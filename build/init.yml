AWSTemplateFormatVersion: '2010-09-09'
Transform: 'AWS::Serverless-2016-10-31'
Description: ''

Parameters:

  Application:
    Description: 'Name of the application for billing'
    Type: 'String'
  
  Environment:
    Description: 'Name of the deployment environment'
    Type: 'String'
  
  DomainName:
    Description: 'The base domain name for the website'
    Type: 'String'
    
  GitHubRepo:
    Description: 'The GitHub repository for this application'
    Type: 'String'
  
  AdminEmail:
    Description: 'Email to which administrative alerts are sent'
    Type: 'String'
  
  AdminPhone:
    Description: 'Mobile phone to which administrative alerts are sent via SMS'
    Type: 'String'

Outputs:

  BuildProject:
    Value: !Sub '${BuildStack.Outputs.BuildProject}'

Resources:

  # Build

  BuildStack:
    Type: 'AWS::CloudFormation::Stack'
    Properties:
      TemplateURL: './build.yml'
      Parameters:
        Application: !Sub '${Application}'
        Environment: !Sub '${Environment}'
        DomainName: !Sub '${DomainName}'
        GitHubRepo: !Sub '${GitHubRepo}'
        AdminEmail: !Sub '${AdminEmail}'
        AdminPhone: !Sub '${AdminPhone}'
      Tags:
        - Key: 'Application'
          Value: !Sub '${Application}'
        - Key: 'Environment'
          Value: !Sub '${Environment}'
        - Key: 'Resource'
          Value: !Sub '${Application}-${Environment}-build-stack'
